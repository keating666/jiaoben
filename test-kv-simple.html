<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>KV æµ‹è¯• - ç®€åŒ–ç‰ˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
        }
        .success { color: green; }
        .error { color: red; }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ Worker å’Œ KV æµ‹è¯•</h1>
    
    <h2>æ­¥éª¤ 1ï¼šæµ‹è¯• Worker æ˜¯å¦åœ¨çº¿</h2>
    <button onclick="testWorker()">æµ‹è¯• Worker</button>
    
    <h2>æ­¥éª¤ 2ï¼šæµ‹è¯• KV åŠŸèƒ½</h2>
    <button onclick="testKV()">æµ‹è¯• KV</button>
    
    <h2>æ­¥éª¤ 3ï¼šæµ‹è¯•ç°æœ‰åŠŸèƒ½</h2>
    <button onclick="testProcess()">æµ‹è¯•è§†é¢‘å¤„ç†</button>
    
    <h2>ç»“æœï¼š</h2>
    <pre id="result">ç­‰å¾…æµ‹è¯•...</pre>
    
    <script>
        const WORKER_URL = 'https://jiaoben-api.keating8500.workers.dev';
        
        function showResult(message, isError = false) {
            const resultEl = document.getElementById('result');
            resultEl.className = isError ? 'error' : 'success';
            resultEl.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        }
        
        async function testWorker() {
            showResult('æµ‹è¯• Worker åŸºç¡€è¿æ¥...');
            try {
                const response = await fetch(`${WORKER_URL}/api/test`);
                const data = await response.json();
                showResult('Worker è¿æ¥æˆåŠŸï¼\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('Worker è¿æ¥å¤±è´¥ï¼š' + error.message, true);
            }
        }
        
        async function testKV() {
            showResult('æµ‹è¯• KV å­˜å‚¨...');
            try {
                const response = await fetch(`${WORKER_URL}/api/kv/test`);
                if (response.status === 404) {
                    showResult('KV æµ‹è¯•ç«¯ç‚¹ä¸å­˜åœ¨ï¼Œè¯·å…ˆéƒ¨ç½²åŒ…å« KV æµ‹è¯•çš„ Worker ä»£ç ', true);
                    return;
                }
                const data = await response.json();
                showResult('KV æµ‹è¯•ç»“æœï¼š\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('KV æµ‹è¯•å¤±è´¥ï¼š' + error.message, true);
            }
        }
        
        async function testProcess() {
            showResult('æµ‹è¯•è§†é¢‘å¤„ç†åŠŸèƒ½...');
            try {
                const response = await fetch(`${WORKER_URL}/api/process`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        douyinUrl: 'https://v.douyin.com/67CMClLwb1c/' 
                    })
                });
                const data = await response.json();
                showResult('è§†é¢‘å¤„ç†å“åº”ï¼š\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('è§†é¢‘å¤„ç†æµ‹è¯•å¤±è´¥ï¼š' + error.message, true);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶å…ˆæµ‹è¯•åŸºç¡€è¿æ¥
        window.onload = () => {
            showResult('å‡†å¤‡å°±ç»ªï¼Œè¯·ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•');
        };
    </script>
</body>
</html>